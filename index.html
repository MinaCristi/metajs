<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Dmytro V. Dogadailo">

    <title>MetaJS is a Lisp that can guess your thoughts and generate missed code | metajs.coect.net</title>

    <meta name="description" content="Lisp compiled to Javascript" />
    <meta name="keywords" content="metajs, javascript, lisp" />
    <meta name="generator" content="DocPad v6.51.6" />
    <meta property="og:title" content="MetaJS is a Lisp that can guess your thoughts and generate missed code | metajs.coect.net" />
    <meta property="og:image" content="http://www.coect.net/img/logo_128.png" />
    <meta property="og:type" content="article" />
    

    <link rel="shortcut icon" href="/favicon.ico" />
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
    <link rel="me" href="http://twitter.com/meta_js">
    <!--link rel="stylesheet"
    href="//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css"-->

    <link rel="stylesheet" href="/css/bootstrap.min.css" />
    <link rel="stylesheet" href="/css/metajs.css" />

    <script src="/js/jquery-min.js"></script>
    <script src="/js/metajs_browser.js"></script>
    <script src="/js/metajs_docs.js"></script>
    <!-- async ga.js tracking  -->
    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-43028517-1']);
      _gaq.push(['_trackPageview']);

      (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript';
      ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' :
      'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(ga, s);
      })();
    </script>
  </head>

  <body id="overview">
    <a href="https://github.com/dogada/metajs" class="hidden-xs">
      <img style="position: absolute; top: 0; right: 0; border: 0;"
	   src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png"
	   alt="Fork me on GitHub">
    </a>

    <div class="container">
      <div class="header">
        <ul class="nav nav-pills">
          <li class="active">
	    <a href="/">Overview</a>
	  </li>
          <li class="">
	    <a href="/tepl/">TEPL</a>
	  </li>
          <li class="">
	    <a href="/faq/">FAQ</a>
	  </li>
          <li>
	    <a href="http://www.coect.net/">Coect.net</a>
	  </li>
        </ul>
      </div>

      <div class="row">
	
        <div class="col-md-3">
	  
	  <ul class="nav overview-toc">
  <li><a href="#introduction">Introduction</a></li>
  <li><a href="#destructuring">Destructuring</a></li>
  <li><a href="#method-and-property-hooks">Hooks</a></li>
  <li><a href="#macros">Macros</a></li>
  <li><a href="#string-interpolation">String interpolation</a></li>
  <li><a href="#functions">Functions</a></li>
  <li><a href="#smart-compilation">Smart compilation</a></li>
  <li><a href="#magic">Magic</a></li>
  <li><a href="#try-more">More</a></li>
</ul>
	  

	  <a href="https://twitter.com/share" class="twitter-share-button"
	     data-via="meta_js" data-size="large"
	     data-related="coect_net:Retire your Email!,d0gada:creator of MetaJS"
	     data-hashtags="MetaJS">Tweet</a>
	  <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document,
	    'script', 'twitter-wjs');
	  </script>

	  
	  <a class="twitter-timeline"  href="https://twitter.com/meta_js"
	     data-widget-id="377682643732537344">Tweets by @meta_js</a>
	  
        </div>


        <div class="col-md-9 content">
	  <h4>Introduction</h4>
<p>MetaJS is Lisp compiled to Javascript. Final code runs in browser or on NodeJs
plaform without runtime dependencies. More about MetaJS background you can find
on <a href="http://www.coect.net/metajs/">coect.net/metajs/</a>. Project Coect aims to
replace outdated Email and XMPP with modern <a href="http://www.coect.net/">universal communication
protocol</a>. MetaJS for Coect plays the same role as Emacs
Lisp for Emacs.</p>
<p>Bellow is an interactive overview of MetaJS language. You can change MetaJS
code as you read docs and imediatelly see generated javascript code.</p>
<h4>Destructuring</h4>
<p>MetaJS supports destructuring in <code>def</code>, <code>get</code>, <code>set</code> forms:</p>
<pre><code class="lang-lisp">(def actors [&quot;Neo&quot; &quot;Trinity&quot; &quot;Morpheus&quot;]
     [neo trinity morpheus] actors)

(let digits [1 2 3]
     [one two three] digits
  (set [one two three] digits))</code></pre>
<h4>Method and property hooks</h4>
<p>For chaining methods calls and object property access there is also method and
property hooks. Literal begining with <code>.</code> is treated as method of the previous
form, next forms are parameters of the method. Literal begining with <code>@</code> is
property of previous form, for example <code>(get obj &#39;prop)</code> can be written as <code>(obj
@prop)</code>. Hooks are espesially useful when they are combined:</p>
<pre><code class="lang-lisp">(d3 .selectAll &quot;circle&quot; .transition
    .duration 750
    .delay #(* %2 10)
    .attr &quot;r&quot; #(Math.sqrt (* %1 scale)))</code></pre>
<h4>Macros</h4>
<p>To define a macro you can use standard Lisp syntax-quote, unquote and unquote-splicing:</p>
<pre><code class="lang-lisp">(defmacro when (x &amp; code)
  `(if ~x (do ~@code)))

(when earth-moves (log &quot;And yet it moves!&quot;))</code></pre>
<h4>String interpolation</h4>
<p>You can embed variables inside <a href="http://en.wikipedia.org/wiki/String_interpolation">interpolated
strings</a> that are started with <code>#</code>.
Inside such strings <code>$symbol</code> is replaced with symbol&#39;s value and <code>$=var</code>
replaced with pair <em>name=value</em>. For escaping <code>$</code> itself use <code>$$</code>.</p>
<pre><code>#&quot;Hello, $name!&quot;
#&quot;$name, you got $$100.&quot;
#&quot;Debug: $=name, $=last-value.&quot;</code></pre>
<h4>Functions</h4>
<p>Functions can have optional parameters and parameters with default values. Each
parameter can be passed positionally or as keyword. In addition function can
accept variable number of parameters that are accessible as list.</p>
<pre><code class="lang-lisp">(defn demo-fn (a b:Thing c:? d:2 &amp; more)
 (log a b c d more))

;; an example of the function call
(demo-fn &quot;Just A&quot; &quot;noumenon&quot; c:42)</code></pre>
<h4>Smart compilation</h4>
<p>MetaJS tries to generate optimized Javascript code. Same MetaJS code can be
compiled to several forms of Javascript code. For example, let&#39;s look at the
classical conditional form <code>if</code> in different contexts.</p>
<pre><code class="lang-lisp">(defn if-return (a b)
  (if a b))</code></pre>
<pre><code class="lang-lisp">(defn if-statement (a b)
  (if a (set b a))
  b)</code></pre>
<pre><code class="lang-lisp">(defn if-expression (a b)
  (log (if a a b)))</code></pre>
<h4 id="magic">Magic</h4>

<p>It&#39;s not a joke  that MetaJS compiler can guess your thoughts and generate
missed parts of code. Let&#39;s look at example bellow where function <code>named-id</code>
requires 2 parameters but it&#39;s called without any parameters. Notice that in the
compiled Javascript code on the right function <code>namedId</code> called with both two
required parameters obtained from local context. How is it done?  It&#39;s
<a href="http://www.coect.net/metajs/">magic</a>.</p>
<pre><code>(defn named-id (id name opt:&quot;&quot;)
  (str id &quot;:&quot; name &quot;:&quot; opt))

(defn logos-demo (id)
  (let name &quot;A name&quot; opt 42
    (named-id)))</code></pre>
<p>MetaJS will do what you mean <strong>only</strong> if you didn&#39;t say what to do. Compiler will
never attempt to be smarter than you. MetaJS will try to resolve only required
function parameters, i.e. do what you said it to do. It will not try to find
optional parameters in the execution context.</p>
<p>In the above example local variable <code>opt</code> from <code>logos-demo</code> function isn&#39;t passed to
<code>named-id</code> function, because <code>opt</code> argument declared as <em>optional</em> for
<code>named-id</code> function (and has default value &ndash; empty string). If you missed a required
variable and MetaJS can&#39;t find it in the call context or there more than one
possible solution, you should see a warning.</p>
<h4>Try more</h4>
<p>For experiments with bigger code parts you can use <a href="/tepl/">Translate Eval
Print Loop (TEPL)</a> or <a href="https://github.com/dogada/metajs#how-to-install-and-try-metajs">install
MetaJS</a> locally.</p>
<p>Look at the discussions about MetaJS on
<a href="http://www.reddit.com/r/lisp/comments/1ltb9r/new_lisp_dialect_can_guess_your_thoughts_and_emit/">Reddit</a>
and <a href="http://www.linux.org.ru/news/opensource/9546490">LOR</a>.</p>
<p>You can find more information about semantic code transformations, examples of
symbolic and entitative MetaJS to JavaScipt transformations in the <a href="/pdf/metajs_semantic_code_transformations.pdf">metajs_semantic_code_transformations.pdf</a>.
Please look also at the high-level MetaJS language overview
<a href="http://metajs.coect.net/pdf/metajs_lisp.pdf">metajs_lisp.pdf</a>.</p>

        </div>
	
      </div>

      <div class="footer">
	<p>Follow us on Twitter <a href="https://twitter.com/coect_net">@meta_js</a> or like
<a href="https://www.facebook.com/pages/Metajs/1389834274578119">MetaJS</a> on Facebook.
Watch <a href="https://github.com/dogada/metajs">source code repository</a> and report
<a href="http://github.com/dogada/metajs/issues">issues</a> on GitHub. Top MetaJS news you
can find also at <a href="https://twitter.com/d0gada">@d0gada</a>.</p>
<p>&copy; Dmytro V. Dogadailo 2013</p>

      </div>

    </div>
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-43028517-1', 'coect.net');
  ga('send', 'pageview');
</script>

  </body>
</html>

